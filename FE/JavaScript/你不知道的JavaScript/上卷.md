
## 作用域和闭包


- 编译原理
	- 引擎 - 代码执行
	- 编译器 - 语法分析，代码生成
	- 作用域 - 收集维护标识符（变量）
- 作用域规则
	- LHS查询
		- 当变量出现在赋值操作的左侧时
		- 赋值操作的目标是谁
		- 查询失败会创建一个变量，严格模式下`ReferenceError`
	- RHS查询
		- 当变量出现在赋值操作的右侧时
		- 非左侧
		- 函数参数会进行 RHS 查询
		- 谁是赋值操作的源头
		- 未找到时`ReferenceError`
- 作用域类型
	- 词法作用域 - js - 作用域
	- 动态作用域 - bash，`this`
	- 概念
		- 定义在词法阶段的作用域
		- 词法作用域意味着作用域是由书写代码时函数声明的位置来决定的
		- 词法作用域是一套关于引擎如何寻找变量以及会在何处找到变量的规则，特征发生在书写阶段
		- 关键点-作用域变量查找是基于函数定义的位置，跟调用位置没有关系！这也是词法作用域的特点
	- 欺骗词法作用域
		- `eval`
		- `with`
- 函数作用域/块作用域
	- `function(){}`
	- `{}`
- 声明提升
	- `var` 声明的变量会提升至顶部，且值为`undefined`
	- `function` 声明也会提升至顶部，且值为定义的函数，并不是`undefined`
- 闭包
	- 当函数可以记住并访问所在的词法作用域时，就产生了闭包
	- 该函数依然持有对该作用域的引用，而这个引用就叫作闭包
- 箭头函数的`this`
	- 词法作用？ - 叫 this词法

## this和对象原型

- 动态作用域
- 调用位置
	- 调用栈中的第二个元素就是调用位置
- 调用规则 - 多个规则，优先级按照以下顺序
	- new
	- call/apply 显示绑定
		- `null`,`undefine`为上下文参数时，将会转化为默认绑定
	- 上下文隐式绑定
	- 默认绑定
		- 严格模式为`undefined`